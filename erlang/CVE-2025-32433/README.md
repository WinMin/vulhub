# Unauthenticated Remote Code Execution in Erlang/OTP SSH (CVE-2025-32433)

[中文文档](README.zh-cn.md)

Erlang/OTP SSH is a component of the Erlang/OTP platform that provides SSH server capabilities. This vulnerability affects the SSH server implementation.

A serious vulnerability has been identified in the Erlang/OTP SSH server that may allow an attacker to perform unauthenticated remote code execution (RCE). By exploiting a flaw in SSH protocol message handling, a malicious actor could gain unauthorized access to affected systems and execute arbitrary commands without valid credentials. Affected versions include OTP-27.3.2 and earlier, OTP-26.2.5.10 and earlier, and OTP-25.3.2.19 and earlier.

References:

- <https://github.com/erlang/otp/security/advisories/GHSA-37cp-fgq5-7wc2>
- <https://github.com/erlang/otp/commit/6eef04130afc8b0ccb63c9a0d8650209cf54892f#diff-ceeb1aeeb602e1424c13d9da9383e0782f65869d6e64e015c194145b1a64edcd>
- <https://github.com/ProDefense/CVE-2025-32433/blob/main/CVE-2025-32433.py>
- <https://datatracker.ietf.org/doc/html/rfc4254>

## Environment Setup

Execute the following command to start an Erlang/OTP SSH server:

```
docker compose up -d
```

After the server starts, it will launch an Erlang SSH daemon inside the container, listening on port 2222, which is also mapped to the local port 2222. You can access it via SSH to test the vulnerability.

## Vulnerability Reproduction

To reproduce the vulnerability, use the exploit script:

```
python3 exploit.py
```

This exploit primarily works by creating an SSH_MSG_CHANNEL_REQUEST (message number 94) to execute commands. According to RFC 4254, it is defined as follows:

```
  byte      SSH_MSG_CHANNEL_REQUEST
  uint32    recipient channel
  string    "exec"
  boolean   want reply
  string    command
```

This message requests the server to start executing the given command. The 'command' string may contain a path. Normal precautions MUST be taken to prevent the execution of unauthorized commands.

Upon successful exploitation, you can see the created 'hacked' file in the /tmp directory of the erlang_ssh_vuln container.  
![](1.png)
