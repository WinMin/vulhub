# Erlang/OTP SSH 未经身份验证的远程代码执行漏洞 (CVE-2025-32433)

Erlang/OTP SSH 是 Erlang/OTP 平台的一个组件，提供 SSH 服务器功能。此漏洞影响 SSH 服务器的实现。

在 Erlang/OTP SSH 服务器中发现了一个严重漏洞，可能允许攻击者执行未经身份验证的远程代码执行 (RCE)。通过利用 SSH 协议消息处理中的缺陷，恶意行为者可以在没有有效凭据的情况下获得对受影响系统的未经授权的访问并执行任意命令。受影响的版本包括 OTP-27.3.2 及更早版本、OTP-26.2.5.10 及更早版本，以及 OTP-25.3.2.19 及更早版本。

参考链接：

- <https://github.com/erlang/otp/security/advisories/GHSA-37cp-fgq5-7wc2>
- <https://github.com/erlang/otp/commit/6eef04130afc8b0ccb63c9a0d8650209cf54892f#diff-ceeb1aeeb602e1424c13d9da9383e0782f65869d6e64e015c194145b1a64edcd>
- <https://github.com/ProDefense/CVE-2025-32433/blob/main/CVE-2025-32433.py>
- <https://datatracker.ietf.org/doc/html/rfc4254>

## 环境设置

执行以下命令以启动 Erlang/OTP SSH 服务器：

```
docker compose up -d
```

服务器启动后，会在容器里启动一个 Erlang SSH 守护程序，监听端口在 2222 上，也映射到本地的 2222 端口上。您可以通过 SSH 访问它以测试漏洞。

## 漏洞复现

使用 exploit.py 来复现漏洞：

```
python3 exploit.py
```

该利用主要通过创建 SSH_MSG_CHANNEL_REQUEST 请求（消息编号 94）来执行命令。根据 RFC 4254，其定义如下：

```
  byte      SSH_MSG_CHANNEL_REQUEST
  uint32    recipient channel
  string    "exec"
  boolean   want reply
  string    command
```

该消息将请求服务器开始执行给定命令。'command' 字符串可能包含路径。必须采取正常的预防措施以防止执行未经授权的命令。

利用成功后，您可以在 erlang_ssh_vuln 容器的 /tmp 目录下看到创建的 'hacked' 文件。  
![](1.png)
